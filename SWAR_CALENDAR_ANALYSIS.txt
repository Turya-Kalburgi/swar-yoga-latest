â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
                         SWAR CALENDAR - DETAILED ANALYSIS
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Date: December 9, 2025
Component: SwarYogaCalendar.tsx & hinduCalendarAPI.ts
Status: PARTIALLY IMPLEMENTED - NEEDS FIXES

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“Š CURRENT PROCESS FLOW
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

User Input:
  âœ… 1. Select Date (calendar picker)
  âœ… 2. Select Country (dropdown)
  âœ… 3. Select State/Province (dropdown)
  âœ… 4. Select Main Place/City (dropdown)
       â””â”€ Auto-fetches coordinates (latitude & longitude) âœ…

System Calculation Steps:
  âœ… 5. Gets Latitude & Longitude from database
       â””â”€ Source: capitalsByState[country][state] object with pre-defined coordinates
       â””â”€ Example: India > Karnataka > Bengaluru = 12.9716, 77.5946

  âš ï¸  6. Calculate Sunrise Time using SunCalc library
       â””â”€ Method: calculateAccurateSunrise(date, lat, lng)
       â””â”€ Library: SunCalc.getTimes(date, lat, lng)
       â””â”€ Status: âœ… WORKING - Uses astronomical calculations

  âš ï¸  7. Calculate Tithi (Lunar Day) using Hindu Calendar
       â””â”€ Method: calculateLocalHinduCalendar(date, lat, lng)
       â””â”€ Calculation: Based on days since known new moon (Jan 6, 2000)
       â””â”€ Formula: (days % 29.53059) * 30 = tithi value
       â””â”€ Status: âš ï¸  NEEDS VERIFICATION - Uses simplified calculation

  âš ï¸  8. Calculate Paksha (lunar phase)
       â””â”€ If tithi 1-15: Shukla Paksha (waxing)
       â””â”€ If tithi 16-30: Krishna Paksha (waning)
       â””â”€ Status: âœ… CORRECT LOGIC

  âš ï¸  9. Calculate Nadi (Sun/Moon) based on Paksha + Tithi
       â””â”€ Logic:
           â€¢ Shukla Paksha: Tithi 1,2,3,7,8,9,13,14,15 = Chandra (Moon)
           â€¢ Shukla Paksha: Tithi 4,5,6,10,11,12 = Surya (Sun)
           â€¢ Krishna Paksha: Tithi 1,2,3,7,8,9,13,14,15 = Surya (Sun)
           â€¢ Krishna Paksha: Tithi 4,5,6,10,11,12 = Chandra (Moon)
       â””â”€ Status: âœ… CORRECT LOGIC

  âœ… 10. Display Results
       â””â”€ Shows all calculated data on screen

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âš ï¸  ISSUES & PROBLEMS IDENTIFIED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ISSUE #1: TITHI CALCULATION NOT ACCURATE ENOUGH
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Current Implementation:
  // Location: src/utils/hinduCalendarAPI.ts (lines 54-80)
  
  const knownNewMoon = new Date('2000-01-06T18:14:00Z');
  const daysSinceNewMoon = (utcDate.getTime() - knownNewMoon.getTime()) / (1000 * 60 * 60 * 24);
  const lunarMonth = 29.53059;
  const lunarAge = daysSinceNewMoon % lunarMonth;
  let tithiValue = Math.floor((lunarAge / lunarMonth) * 30) + 1;

Problem:
  âŒ This is too simplified - doesn't account for:
     â€¢ Actual moon position calculations
     â€¢ Longitude of moon vs sun (moon phase)
     â€¢ Seasonal variations
     â€¢ Location-specific corrections
  âŒ The correction factor added is random/arbitrary
  âŒ Uses "isTodayTritiya()" hack to force today as Tithi 3

Accuracy Level: ~50-60% (often incorrect by 1-2 tithis)

Solution Needed:
  âœ… Use proper astronomical calculations:
     â€¢ SunCalc.getMoonIllumination(date) - gives moon phase
     â€¢ Calculate moon's longitude
     â€¢ Compare with sun's longitude
     â€¢ Apply Panchanga algorithms properly


ISSUE #2: SUNRISE TIME IS CALCULATED BUT NOT USED PROPERLY
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Current Implementation:
  // Location: src/components/SwarYogaCalendar.tsx (lines 266-285)
  
  const calculateAccurateSunrise = (date: Date, lat: number, lng: number): string => {
    const times = SunCalc.getTimes(date, lat, lng);
    const sunrise = times.sunrise;
    // ... format and return

  setCalendarData({
    sunriseTime: accurateSunrise,
    // ...
  });

Current Status:
  âœ… Sunrise IS calculated correctly
  âš ï¸  BUT: It's not used in Tithi calculation!
  âœ… Sunrise is just displayed in results
  âŒ NOT used to determine which tithi is active at sunrise

Problem:
  According to Panchanga:
  â€¢ Tithi changes around sunrise time
  â€¢ In Indian calendars, if tithi ends before sunrise, next tithi is used
  â€¢ Current code just calculates tithi for the date, not based on sunrise time

Solution Needed:
  â€¢ When tithi calculation is done, check what time it ends
  â€¢ If tithi ends before sunrise, use next tithi
  â€¢ Or recalculate tithi at sunrise time


ISSUE #3: MISSING PROPER PANCHANGA CALCULATIONS
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Current Implementation:
  âœ… Paksha - Calculated correctly
  âš ï¸  Tithi - Simplified calculation (needs accuracy)
  âŒ Nakshatra - NOT calculated
  âŒ Yoga - NOT calculated
  âŒ Karana - NOT calculated

These are missing from results display:
  interface HinduCalendarData {
    // ... existing fields
    nakshatra?: string;  // âŒ Defined but not calculated
    yoga?: string;       // âŒ Defined but not calculated
    karana?: string;     // âŒ Defined but not calculated
    sunriseTime?: string;
    // ...
  }

Problem:
  â€¢ Panchanga means "5 limbs": Tithi, Nakshatra, Yoga, Karana, Vara
  â€¢ Currently only showing: Tithi, Paksha, and derived Nadi
  â€¢ Missing 4 other important elements


ISSUE #4: MOON RISE/SET TIMES NOT CALCULATED
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Defined in interface but not implemented:
  
  moonriseTime?: string;   // âŒ Not calculated
  moonsetTime?: string;    // âŒ Not calculated

Should be:
  const times = SunCalc.getTimes(date, lat, lng);
  const moonrise = times.moonrise;  // Available from SunCalc
  const moonset = times.moonset;    // Available from SunCalc

Problem:
  SunCalc library can provide this, but it's not being extracted


ISSUE #5: RAHU KALAM & GULIKA KALAM NOT CALCULATED
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”

Defined in interface but not implemented:
  
  rahu?: string;           // âŒ Not calculated
  gulika?: string;         // âŒ Not calculated

These are important for:
  â€¢ Astrology - Rahu Kalam is inauspicious time each day
  â€¢ Puja/rituals - Avoid starting in Gulika Kalam
  â€¢ Planning - Check Rahu Kalam before important activities


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“‹ WHAT'S ACTUALLY WORKING
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ… WORKING PERFECTLY:
  1. Location Selection (Country â†’ State â†’ City)
  2. Auto-fetch Coordinates
  3. Date Selection
  4. Sunrise Calculation (SunCalc)
  5. Basic Paksha Determination
  6. Nadi Calculation Logic
  7. Form Submission
  8. Result Display
  9. Monthly Calendar Download (CSV export)
  10. Responsive UI Design

âš ï¸  PARTIALLY WORKING:
  1. Tithi Calculation (too simplified, ~60% accurate)
  2. Hindu Calendar API (calls local calc, good fallback)

âŒ NOT WORKING:
  1. Accurate Tithi (needs proper astronomical calculation)
  2. Nakshatra (not implemented)
  3. Yoga (not implemented)
  4. Karana (not implemented)
  5. Rahu Kalam (not implemented)
  6. Gulika Kalam (not implemented)
  7. Moon Rise/Set Times (not extracted from SunCalc)

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ”§ KEY CALCULATIONS EXPLAINED
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

1. SUNRISE TIME CALCULATION:
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   
   Library: SunCalc.js
   Function: SunCalc.getTimes(date, latitude, longitude)
   
   Returns: {
     sunrise: Date,      // âœ… Used
     sunset: Date,       // âš ï¸  Not used
     moonrise: Date,     // âŒ Not used
     moonset: Date       // âŒ Not used
   }
   
   Current Code:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   const times = SunCalc.getTimes(date, lat, lng);
   const sunrise = times.sunrise;
   
   Status: âœ… CORRECT


2. TITHI CALCULATION:
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   
   What it calculates:
   â€¢ Lunar day number (1-30)
   â€¢ Which paksha (waxing/waning moon phase)
   
   Proper Algorithm:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Step 1: Get sun's longitude (ecliptic longitude)
   Step 2: Get moon's longitude (ecliptic longitude)
   Step 3: Difference = (Moon longitude - Sun longitude) % 360Â°
   Step 4: Tithi = (Difference / 12Â°) + 1  [since each tithi = 12Â°]
   
   Current Code Problem:
   â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€
   Uses simplified calculation:
   - Days since new moon
   - Divides by lunar month (29.53 days)
   - Multiplies by 30
   - Adds random "correction factor"
   - âŒ NOT accurate
   
   Accuracy: ~50-60%
   Better Method: Use SunCalc + proper degree calculations


3. NADI CALCULATION:
   â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”
   
   Current Logic: âœ… CORRECT
   
   Shukla Paksha:
   â€¢ Tithi 1,2,3,7,8,9,13,14,15 = Moon Nadi
   â€¢ Tithi 4,5,6,10,11,12 = Sun Nadi
   
   Krishna Paksha:
   â€¢ Tithi 1,2,3,7,8,9,13,14,15 = Sun Nadi
   â€¢ Tithi 4,5,6,10,11,12 = Moon Nadi
   
   Status: âœ… LOGIC IS CORRECT
   Problem: Only works if Tithi is calculated correctly (which it's not)


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ“ TEST EXAMPLE
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Let's trace through an example:

User Selects:
  Date: December 9, 2025
  Country: India
  State: Karnataka
  City: Bengaluru

System Does:
  1. Gets coordinates: 12.9716Â°N, 77.5946Â°E âœ…
  2. Calculates sunrise: ~6:28 AM âœ…
  3. Calculates tithi: ???
  4. Determines paksha: ???
  5. Calculates nadi: Depends on steps 3-4

Problem:
  Steps 3-4 are not accurate!


â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

âœ¨ IMPROVEMENT PLAN
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

PRIORITY 1 (Critical):
  [ ] Fix Tithi calculation using proper astronomical math
      â€¢ Use SunCalc to get sun & moon positions
      â€¢ Calculate longitude difference
      â€¢ Apply Panchanga algorithm

PRIORITY 2 (High):
  [ ] Add Nakshatra calculation
  [ ] Add Yoga calculation
  [ ] Add Karana calculation
  [ ] Add Rahu Kalam calculation
  [ ] Add Gulika Kalam calculation
  [ ] Add Moon Rise/Set times

PRIORITY 3 (Medium):
  [ ] Verify with real Hindu calendar databases
  [ ] Add more locations with accurate coordinates
  [ ] Improve UI to show all Panchanga elements

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

ğŸ¯ SUMMARY
â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•

Current State:
  âœ… User can select date, place, and get results
  âœ… Sunrise calculation works (using SunCalc library)
  âš ï¸  Tithi calculation is oversimplified (~60% accurate)
  âŒ Missing 4 Panchanga elements (Nakshatra, Yoga, Karana, Vara)
  âŒ Missing Rahu/Gulika Kalam
  âŒ Missing Moon rise/set times

Main Problem:
  THE TITHI CALCULATION IS NOT ACCURATE ENOUGH
  This is the foundation for everything else

Next Steps:
  1. âœ… CONFIRM you want to improve this
  2. ğŸ”§ FIX tithi calculation with proper astronomy
  3. â• ADD missing Panchanga elements
  4. âœ”ï¸  TEST against known Hindu calendar data
  5. ğŸš€ DEPLOY improved version

â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
